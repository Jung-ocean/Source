From bongan Kim based on http://pordlabs.ucsd.edu/matlab/stream.htm